<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ´»å‹•åŸ·è¡Œå¤§è¡¨ - 2026 å°ˆæ¥­ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background: #f8fafc; font-size: 13px; }
        /* ç§»é™¤ fixedï¼Œè®“è¡¨æ ¼èƒ½æ ¹æ“šå…§å®¹æ’é–‹ */
        .rundown-table, .item-table { width: 100%; border-collapse: collapse; border: 2px solid black; background: white; }
        .rundown-table th, .rundown-table td, .item-table th, .item-table td { border: 1.2px solid black; padding: 8px; vertical-align: top; }
        .bg-gray-header { background-color: #f3f4f6; }
        .input-line { border: none; border-bottom: 1px solid black; outline: none; background: transparent; }
        
        /* è®“æ–‡å­—å€å¡Šå¯ä»¥è‡ªå‹•æ›è¡Œä¸¦æ’é–‹é«˜åº¦ */
        .auto-height-cell { 
            min-height: 40px; 
            white-space: pre-wrap; 
            word-break: break-all;
            outline: none;
        }

        .select-container { display: flex; flex-direction: column; gap: 2px; }
        select { background: #f9fafb; outline: none; width: 100%; cursor: pointer; font-size: 11px; border: 1px solid #ddd; border-radius: 2px; }
        
        /* å›ºå®šå°æ¬„ä½çš„å¯¬åº¦ï¼Œå…¶é¤˜è®“çµ¦æ–‡å­— */
        .col-time { width: 120px; text-align: center; }
        .col-len { width: 60px; text-align: center; }
        .col-job, .col-staff { width: 100px; }
        .col-op { width: 40px; text-align: center; }
        
        .time-display { font-family: 'Courier New', monospace; font-weight: bold; color: #1d4ed8; }
        .checkbox-item { display: flex; align-items: center; padding: 3px 0; font-size: 12px; gap: 5px; }
        .num-input { width: 45px; border: 1px solid #ccc; border-radius: 3px; padding: 1px 2px; text-align: center; }
        .add-item-btn { font-size: 10px; color: #2563eb; cursor: pointer; text-decoration: underline; margin-top: 4px; display: block; }
    </style>
</head>
<body class="p-2">

    <div class="max-w-[1600px] mx-auto">
        <div class="bg-white p-4 rounded shadow border mb-3 flex flex-wrap gap-4 font-bold text-sm items-center">
            <div>ä¸»é¡Œï¼š<input type="text" class="input-line w-48" value="2026 è¨˜è€…æœƒ"></div>
            <div>æ—¥æœŸï¼š<input type="date" id="eventDate" class="input-line" onchange="updateDayOfWeek()"><span id="dayOfWeek" class="ml-1 text-blue-600"></span></div>
            <div>åœ°é»ï¼š<input type="text" class="input-line w-40"></div>
            <div>ä¸»æŒäººï¼š
                <select id="headerHost" class="input-line w-28 border-b border-black font-bold" onchange="syncHostName()">
                    <option value="Yin">Yin</option><option value="å°å·«">å°å·«</option><option value="Peter">Peter</option><option value="å°æŸ”">å°æŸ”</option><option value="manual">æ‰‹å‹•è¼¸å…¥...</option>
                </select>
            </div>
            <div class="flex-1 text-right flex justify-end gap-2">
                <button onclick="calculateAllTimes()" class="bg-amber-500 text-white px-3 py-1.5 rounded text-xs shadow hover:bg-amber-600 font-bold">ğŸ”„ å³æ™‚æ›´æ–°</button>
                <a href="https://script.google.com/macros/s/AKfycbyKe0EVXuPva48B_ocPMpJBRjG-kLbyhDf4eeofN5Mnq060Mb60OucBXtLRqxK2ON6w9Q/exec" target="_blank" class="bg-blue-600 text-white px-4 py-1.5 rounded text-xs shadow hover:bg-blue-700 font-bold">ğŸ™ï¸ é•·å®˜ç°½åˆ°æƒ…æ³</a>
            </div>
        </div>

        <div class="bg-white p-2 shadow-lg border mb-6 overflow-x-auto">
            <div class="flex justify-between mb-2 px-1 text-xs font-bold text-blue-600">
                <span>â€» æµç¨‹è¡¨ (æ–‡å­—è¼¸å…¥æœƒè‡ªå‹•æ’é–‹åˆ—é«˜)</span>
                <button onclick="addRow()" class="bg-green-600 text-white px-4 py-1 rounded font-bold hover:bg-green-700 shadow-md">+ å¢åŠ ä¸€è¡Œ</button>
            </div>
            <table id="rundownTable" class="rundown-table">
                <thead>
                    <tr class="bg-gray-header text-xs">
                        <th class="col-time">æ™‚é–“å€æ®µ</th>
                        <th class="col-len">é•·åº¦</th>
                        <th style="min-width: 200px;">å–®å…ƒé …ç›®</th>
                        <th style="min-width: 350px;">é‡é»å·¥ä½œå…§å®¹</th>
                        <th class="col-job">åˆ†å·¥</th>
                        <th class="col-staff">äººå“¡</th>
                        <th class="col-op">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="rundownBody"></tbody>
            </table>
        </div>

        <div class="bg-white p-4 shadow-lg border">
            <div class="flex items-center mb-2 border-l-4 border-blue-600 pl-2">
                <h3 class="font-black text-lg">å™¨ææ¸…å–®æ ¸å° (å«æ•¸é‡å¡«å¯«)</h3>
            </div>
            <table class="item-table text-xs">
                <thead>
                    <tr class="bg-gray-800 text-white text-center">
                        <th class="w-1/2 py-2">æœå‹™å°ç›¸é—œ</th>
                        <th class="w-1/2 py-2">èˆå°ç›¸é—œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="serviceDeskItems"></td>
                        <td id="stageItems"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        const staffs = ["éµä»", "æŸç·¯", "æ±Ÿå“¥", "ç‘©é©Š", "éœ²æ¯”", "èŠ³ç‘œ", "å´§ç‘‹", "å·¥è®€1", "å·¥è®€2"];
        const jobs = ["æ§å ´", "éŸ³éŸ¿", "ä¸»æŒäºº", "émic", "ä¸Šæ‰‹æ¿", "ä¸Šé“å…·", "æ”å½±", "æœå‹™å°"];
        
        const serviceItems = [
            {n:"æœå‹™å°ç®±", q:false}, {n:"ç°½åˆ°è¡¨", q:false}, {n:"é•·å®˜è²´è³“åå–®", q:false}, {n:"æ¡Œå¸ƒ", q:false},
            {n:"é¤ç›’", q:true}, {n:"é•·æ¡Œ", q:true}, {n:"æ–°èè³‡æ–™", q:true}, {n:"ç“¶æ°´",
                                                                     
